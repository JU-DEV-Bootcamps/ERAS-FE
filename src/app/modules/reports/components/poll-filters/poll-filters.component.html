<form [formGroup]="filterForm">
  @if (polls === null) {
    <p class="error-message">
      There was an error looking for polls. Please contact support
    </p>
  }
  <div class="form-container">
    @if (polls !== null) {
      <app-select-virtual-scroll
        [items]="pollsToScroll()"
        [control]="filterForm.controls.selectedPoll"
        [id]="'sl-poll'"
        [label]="'Poll'"
        (selectionChange)="handlePollSelect($event)"
      />
    }

    @if (filterForm.value.selectedPoll) {
      <app-select-virtual-scroll
        [items]="pollVersionsToScroll()"
        [control]="filterForm.controls.lastVersion"
        [id]="'sl-version'"
        [label]="'Version'"
        (selectionChange)="handleVersionSelect($event)"
      />

      <app-select-multiple-virtual-scroll
        [items]="cohortsToScroll()"
        [control]="filterForm.controls.cohortIds"
        [id]="'sl-cohort'"
        [label]="'Cohorts'"
        (openedChange)="handleCohortSelect($event)"
      />
    }
    @if (
      filterForm.value.cohortIds &&
      filterForm.value.cohortIds.length &&
      showVariables
    ) {
      <app-select-multiple-virtual-scroll
        [items]="componentsToScroll()"
        [control]="filterForm.controls.componentNames"
        [id]="'sl-components'"
        [label]="'Components'"
        (openedChange)="handleComponentsSelect($event)"
      />
    }
    @if (
      filterForm.value.cohortIds &&
      filterForm.value.cohortIds.length &&
      showVariables
    ) {
      <app-select-multiple-virtual-scroll
        [control]="filterForm.controls.variables"
        [id]="'sl-variables'"
        [label]="'Variables'"
        [groups]="variableSelectGroups()"
        (openedChange)="handleVariableSelect($event)"
      />
    }
  </div>
</form>
