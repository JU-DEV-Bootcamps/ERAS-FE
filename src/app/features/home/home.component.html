<div>
  <h1 class="page-title">Home</h1>
  <h2 class="page-subtitle">Overview</h2>
  @if (summaryReqError) {
    <span class="error-message">Could not load all summary details.</span>
  }
  <div class="section">
    <mat-card class="link-card" routerLink="/cohort">
      <mat-icon>account_balance</mat-icon>
      <mat-card-title>Cohorts</mat-card-title>
      <mat-card-footer>{{
        cohortsSummary?.cohortCount || '?'
      }}</mat-card-footer>
    </mat-card>
    <mat-card class="link-card" routerLink="/list-students-by-poll">
      <mat-icon>group</mat-icon>
      <mat-card-title>Students</mat-card-title>
      <mat-card-footer>{{
        cohortsSummary?.studentCount || '?'
      }}</mat-card-footer>
    </mat-card>
    <mat-card class="link-card" routerLink="/list-polls-by-filters">
      <mat-icon>file_copy</mat-icon>
      <mat-card-title>Polls Answered</mat-card-title>
      <mat-card-footer>{{
        cohortsSummary?.studentCount || '?'
      }}</mat-card-footer>
    </mat-card>
    <mat-card class="link-card" routerLink="/evaluation-process">
      <mat-icon>insert_chart</mat-icon>
      <mat-card-title>Evaluations</mat-card-title>
      <mat-card-footer>{{ evalProcSummary?.length }}</mat-card-footer>
    </mat-card>
  </div>

  <h2 class="page-subtitle">Evaluation Processes</h2>
  @if (evalProcSummary && evalProcSummary.length > 0) {
    <div #mainContainer>
      <div class="student-header">
        <div class="student-info">
          <h2 class="page-title">{{ evalProcSummary[idxChosenEval].name }}</h2>
          <h4 class="page-subtitle">
            Status: {{ evalProcSummary[idxChosenEval].status }}
          </h4>
          <h4 class="page-ssid">
            ID: {{ evalProcSummary[idxChosenEval].evaluationPollId }}
          </h4>
        </div>
      </div>

      <div class="container">
        <mat-card class="card-details">
          <h3 class="title">Student Details</h3>
          <p>
            Name:
            {{ evalProcSummary[idxChosenEval].name }}
          </p>
          <p>
            Poll name:
            {{ evalProcSummary[idxChosenEval].name }}
          </p>
          <p>
            Date:
            {{ evalProcSummary[idxChosenEval].startDate | date }} to
            {{ evalProcSummary[idxChosenEval].endDate | date }}
          </p>
          <p>Status: {{ evalProcSummary[idxChosenEval].status }}</p>
        </mat-card>
        <section class="main" id="chart-student-detail">
          <swiper-container
            id="swiper-container"
            class="swiper"
            effect="cards"
            grab-cursor="true"
            (swiperslidechange)="onSlideChange($event)"
          >
            @for (evaluation of evalProcSummary; track $index) {
              <swiper-slide>
                <h3 class="title">Last evaluations</h3>
                <p class="date-risk-by-components">
                  Poll Name: {{ evaluation.name }}
                </p>
                <p class="date-risk-by-components">
                  Status: {{ evaluation.status }}
                </p>
                <div class="chart-container" #chart>
                  @if (
                    chartOptions &&
                    chartOptions.series &&
                    chartOptions.chart &&
                    chartOptions.plotOptions
                  ) {
                    <apx-chart
                      [series]="chartOptions.series"
                      [chart]="chartOptions.chart"
                      [plotOptions]="chartOptions.plotOptions"
                      [xaxis]="chartOptions.xaxis!"
                      [tooltip]="chartOptions.tooltip!"
                    >
                    </apx-chart>
                  }
                </div>
              </swiper-slide>
            }
          </swiper-container>
        </section>
      </div>
    </div>
  } @else {
    <app-empty-data-message
      description="No evaluation process with polls answered yet."
    ></app-empty-data-message>
  }
  <h2 class="page-subtitle">Connected Services</h2>
  <div class="section">
    <mat-card class="services-card">
      <mat-card-title>Cosmic Latte</mat-card-title>
      <mat-icon class="cl-icon">local_drink</mat-icon>
      <mat-card-actions>
        @if (healthCheckStatus) {
          <mat-icon class="check">check</mat-icon>
        } @else {
          <mat-icon class="close">close</mat-icon>
        }
        <p>{{ healthCheckStatus ? 'OK' : 'NOK' }}</p>
        <button mat-mini-fab aria-label="Service Settings">
          <mat-icon routerLink="/cosmic-latte">settings</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
